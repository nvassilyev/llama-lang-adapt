Work in progress. Runs in Python 3.10.9.